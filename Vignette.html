<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rushani Wijesuriya" />

<meta name="date" content="2020-09-09" />

<title>Illustration of multiple imputation approaches for incomplete three-level data: accomodating inetractions and non-linear terms</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Illustration of multiple imputation approaches for incomplete three-level data: accomodating inetractions and non-linear terms</h1>
<h4 class="author">Rushani Wijesuriya</h4>
<h4 class="date">2020-09-09</h4>



<p>This vignette provides a worked example on simulated data (which can be found <a href="https://raw.githack.com/moreno-betancur/medRCT/master/medRCT_4med.R">here</a>), illutstrating the multiple imputation (MI) approaches that can be used to handle incomplete three-level data. Our focus is on three-level data resulting from repeated measures nested within higher-level clusters and when the target analysis model includes interactions or quadratic effects involving incomplete covariates which need to be incorporated in the imputation model. An evaluation of these approaches via simulations and an emperical illustation can be found in the paper:</p>
<blockquote>
<p>Wijesuriya R, Moreno-Betancur M, Carlin JB, De Silva AP, Lee KJ . “Evaluation of approaches for accommodating interactions and non-linear terms in multiple imputation of incomplete three-level data”. <a href="https://arxiv.org/abs/1907.06734">https://arxiv.org/abs/1907.06734</a></p>
</blockquote>
<p>To demonstrate the approaches we consider three random intercept models common in longitudinal settings involving:</p>
<ul>
<li>an interaction between the time-varying exposure and a time</li>
<li>an interaction between the time-varying exposure and a time-fixed confounder</li>
<li>a quadratic effect of the exposure</li>
</ul>
<div id="analysis-model-1-interaction-between-the-time-varying-exposure-and-time" class="section level2">
<h2>Analysis model 1: Interaction between the time-varying exposure and time</h2>
<p>For the illustration of MI approaches under analysis model 1 we use the dataset <code>simdatT1.csv</code> (downloadable <a href="https://raw.githack.com/moreno-betancur/medRCT/master/dat4med.csv">here</a>) that was simulated closely following the real data from the Childhood to Adoloscenese Transition Study (CATS).</p>
<p>The dataset consists of the following variables:</p>
<ul>
<li>c_id: child’s ID</li>
<li>school: Child’s school cluster indicator</li>
<li>age: Child’s age (wave 1) (years)</li>
<li>sex: Child’s sex</li>
<li>SES_z: Standardized SES measured by the SEIFA IRSAD (wave 1)</li>
<li>NAPLAN1_Z: Standardized NAPLAN numeracy score (wave 1)</li>
<li>time: wave/time point</li>
<li>prev_dep: Depressive symptoms (waves 2,4 and 6)</li>
<li>NAPLAN_Z: Standardized NAPLAN numeracy score (waves 3,5 and 7)</li>
<li>prev_sdq: Overall child behaviour reported by SDQ (waves 2,4 and 6)</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="right">c_id</th>
<th align="right">school</th>
<th align="right">age</th>
<th align="left">sex</th>
<th align="right">SES_z</th>
<th align="right">NAPLAN1_z</th>
<th align="right">time</th>
<th align="right">prev_dep</th>
<th align="right">NAPLAN_z</th>
<th align="right">prev_sdq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.497667</td>
<td align="left">female</td>
<td align="right">-1.3272403</td>
<td align="right">-0.3033435</td>
<td align="right">3</td>
<td align="right">4.9278054</td>
<td align="right">-1.1412290</td>
<td align="right">31.57202</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.497667</td>
<td align="left">female</td>
<td align="right">-1.3272403</td>
<td align="right">-0.3033435</td>
<td align="right">5</td>
<td align="right">2.5367732</td>
<td align="right">-0.9059286</td>
<td align="right">25.64610</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">8.497667</td>
<td align="left">female</td>
<td align="right">-1.3272403</td>
<td align="right">-0.3033435</td>
<td align="right">7</td>
<td align="right">-0.4074601</td>
<td align="right">0.4725228</td>
<td align="right">20.76163</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">8.652603</td>
<td align="left">male</td>
<td align="right">NA</td>
<td align="right">-1.0476853</td>
<td align="right">3</td>
<td align="right">3.4788270</td>
<td align="right">0.0562835</td>
<td align="right">26.85478</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">8.652603</td>
<td align="left">male</td>
<td align="right">NA</td>
<td align="right">-1.0476853</td>
<td align="right">5</td>
<td align="right">-0.0963325</td>
<td align="right">0.3803842</td>
<td align="right">19.45729</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">1</td>
<td align="right">8.652603</td>
<td align="left">male</td>
<td align="right">NA</td>
<td align="right">-1.0476853</td>
<td align="right">7</td>
<td align="right">-0.8500218</td>
<td align="right">-1.9173808</td>
<td align="right">16.21050</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">7.630407</td>
<td align="left">female</td>
<td align="right">0.1238728</td>
<td align="right">-0.7251261</td>
<td align="right">3</td>
<td align="right">2.6864002</td>
<td align="right">-0.6767193</td>
<td align="right">24.91249</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">7.630407</td>
<td align="left">female</td>
<td align="right">0.1238728</td>
<td align="right">-0.7251261</td>
<td align="right">5</td>
<td align="right">4.8701096</td>
<td align="right">-0.6348274</td>
<td align="right">26.55796</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">1</td>
<td align="right">7.630407</td>
<td align="left">female</td>
<td align="right">0.1238728</td>
<td align="right">-0.7251261</td>
<td align="right">7</td>
<td align="right">1.5458537</td>
<td align="right">-0.2862000</td>
<td align="right">20.23706</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">8.847804</td>
<td align="left">male</td>
<td align="right">-0.8842382</td>
<td align="right">-0.0862409</td>
<td align="right">3</td>
<td align="right">0.6805942</td>
<td align="right">-0.1611126</td>
<td align="right">13.96553</td>
</tr>
</tbody>
</table>
<p>The time varying variable <code>prev_dep</code> and the time-fixed variable <code>SES_z</code> are incomplete, while all the other variables are completely observed.</p>
<div id="single-level-jm-with-di-indicators-for-the-higher-level-clusters-and-repeated-measures-imputed-in-wide-format-jm-1l-di-wide" class="section level3">
<h3>Single-level JM with DI indicators for the higher level clusters and repeated measures imputed in wide format (JM-1L-DI-wide)</h3>
</div>
<div id="single-level-fcs-with-di-indicators-for-the-higher-level-clusters-and-repeated-measures-imputed-in-wide-format-fcs-1l-di-wide" class="section level3">
<h3>Single-level FCS with DI indicators for the higher level clusters and repeated measures imputed in wide format (FCS-1L-DI-wide)</h3>
</div>
<div id="two-level-jm-for-the-higher-level-clusters-with-repeated-measures-imputed-in-wide-format-jm-2l-wide" class="section level3">
<h3>Two-level JM for the higher level clusters with repeated measures imputed in wide format (JM-2L-wide)</h3>
</div>
<div id="two-level-fcs-for-the-higher-level-clusters-with-repeated-measures-imputed-in-wide-format-fcs-2l-wide" class="section level3">
<h3>Two-level FCS for the higher level clusters with repeated measures imputed in wide format (FCS-2L-wide)</h3>
</div>
<div id="two-level-smc-jm-for-the-repeated-measures-with-di-for-the-higher-level-clusters-smc-jm-2l-di" class="section level3">
<h3>Two-level SMC-JM for the repeated measures with DI for the higher-level clusters (SMC-JM-2L-DI)</h3>
</div>
<div id="two-level-smc-sm-for-the-repeated-measures-with-di-for-the-higher-level-clusters-smc-sm-2l-di" class="section level3">
<h3>Two-level SMC-SM for the repeated measures with DI for the higher-level clusters (SMC-SM-2L-DI)</h3>
<p>You can enable figure captions by <code>fig_caption: yes</code> in YAML:</p>
<pre><code>output:
  rmarkdown::html_vignette:
    fig_caption: yes</code></pre>
<p>Then you can use the chunk option <code>fig.cap = &quot;Your figure caption.&quot;</code> in <strong>knitr</strong>.</p>
</div>
</div>
<div id="more-examples" class="section level2">
<h2>More Examples</h2>
<p>You can write math expressions, e.g. <span class="math inline">\(Y = X\beta + \epsilon\)</span>, footnotes<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>, and tables, e.g. using <code>knitr::kable()</code>.</p>
<p>Also a quote using <code>&gt;</code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>A footnote here.<a href="#fnref1" class="footnote-back">↩</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
